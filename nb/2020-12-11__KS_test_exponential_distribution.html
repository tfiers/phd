<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2020-12-11 &#8226; KS test exponential distribution &#8212; Voltage-to-Wiring Sim</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet" href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" type="text/css">
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css">
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css">
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css">
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css">
    <link rel="stylesheet" type="text/css" href="../_static/my_style_mods.css">
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css">
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css">
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/build_status.js"></script>
    <script src="../_static/resize_retina_figures.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@%5E0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"bold": ["\\boldsymbol{#1}", 1]}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="canonical" href="https://tfiers.github.io/phd/nb/2020-12-11__KS_test_exponential_distribution.html">
    <link rel="shortcut icon" href="../_static/favicon.ico">
    <link rel="index" title="Index" href="../genindex.html">
    <link rel="search" title="Search" href="../search.html">
    <link rel="next" title="2020-11-27 &#8226; Permutation test for \(p(\)connected\()\)" href="2020-11-27__permutation_test.html">
    <link rel="prev" title="2020-12-30 &#8226; Test connection of all incoming neurons" href="2020-12-30__test_all_connections.html">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-121684982-2', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>

  <meta name="robots" content="noindex"><meta name="google-site-verification" content="QPn27BqA5LpMmT7Y7mFDLlWCeUw5aVcr74ShytJ3hJU"></head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Voltage-to-Wiring Sim</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off">
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Notebooks
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="2022-08-29__Visualizing_subnets.html">
   2022-08-29 &#8226; Visualizing subnets
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-08-28__Centred_STAs.html">
   2022-08-28 &#8226; Centred STAs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-08-21__Area-under-STA.html">
   2022-08-21 &#8226; Area under STA (new conntest)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-08-17__Investigate_correlated_spikers.html">
   2022-08-17 &#8226; Investigate correlated spikers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-08-05__Spiketrain-correlations.html">
   2022-08-05 &#8226; Spiketrain correlations (of unconnected-but-detected)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-26__Multiseed.html">
   2022-07-26 &#8226; Multiseed
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-23__Record_many.html">
   2022-07-23 &#8226; Record many neurons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-15__Network_plus_noise.html">
   2022-07-15 &#8226; Network + VI Noise
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-14__Unconnected-but-detected.html">
   2022-07-14 &#8226; Not directly connected but detected
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-05__Network-conntest.html">
   2022-07-05 &#8226; Network conntest Roxin params
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-01__g_EI.html">
   2022-07-01 &#8226; g_EI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-05-13__Network.html">
   2022-05-13 &#8226; Network
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-05-02__STA_mean_vs_peak-to-peak.html">
   2022-05-02&#8226; STA mean vs peak-to-peak
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-04-28__interpolate_N_from_30_to_6000.html">
   2022-04-28 &#8226; Interpolate N = 30 .. 6000
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-03-28__total_stimulation.html">
   2022-03-28 &#8226; The invariant measure: total stimulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-03-02__detection_rate_big-N-to-1.html">
   2022-03-02 &#8226; Duration &amp; SNR for big-N&#8211;to&#8211;1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-02-21b__FENS_abstract.html">
   2022-02-21 &#8226; FENS 2022 Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-02-21__image_window_test.html">
   2022-02-21 &#8226; Image, window, test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-02-20__vanilla_julia_fixed_dt_solver.html">
   2022-02-20 &#8226; Fixed timestep Euler solver in vanilla Julia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-02-07__N_to_1_simulation.html">
   2022-02-07 &#8226; N-to-1 simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-01-08__lognormal_firing_rates.html">
   2022-01-08 &#8226; Lognormal input firing rates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-08__biology_vs_Izh_subhtr.html">
   2021-12-08 &#8226; Biology vs Izhikevich subthreshold
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-06__local_HH_dV_shape.html">
   2021-12-06 &#8226; Local shape of
   <span class="math notranslate nohighlight">
    \(\dot{V}\)
   </span>
   in 2D HH
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-02__LIF_vs_Izh_subthreshold.html">
   2021-12-02 &#8226; LIF vs Izhikevich subthreshold
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-11__vary_both_inh_strength_and_proportion.html">
   2021-11-11 &#8226; Vary both inhibitory strength and proportion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-05__vary_syncond_ratio.html">
   2021-11-05 &#8226; Vary I/E synaptic conductances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-09-16__vary_E_vs_I.html">
   2021-09-27 &#8226; Vary E/I proportion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-07-30__inhibitory.html">
   2021-07-30 &#8226; Inhibitory connections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-01-13__multiple_ROC.html">
   2021-01-13 &#8226; Multiple ROC&#8217;s
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-01-06__ROC.html">
   2021-01-06 &#8226; ROC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-01-01__vary_params.html">
   2021-01-01 &#8226; Influence of simulation params on connection test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-12-30__test_all_connections.html">
   2020-12-30 &#8226; Test connection of
   <em>
    all
   </em>
   incoming neurons
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2020-12-11 &#8226; KS test exponential distribution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-27__permutation_test.html">
   2020-11-27 &#8226; Permutation test for
   <span class="math notranslate nohighlight">
    \(p(\)
   </span>
   connected
   <span class="math notranslate nohighlight">
    \()\)
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-10-23__Delete_around_spike.html">
   2020-10-23 &#8226; Delete signal around spikes before STA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-18__Clip_spikes_before_STA.html">
   2020-09-18 &#8226; Clip spikes before STA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-09-10__STA_for_different_PSP_shapes.html">
   2020-09-10 &#8226; STA for &#8800; PSP shapes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-07-29__STA.html">
   2020-07-29 &#8226; Spike-triggered averaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-07-27__Synaptic_conductances.html">
   2020-07-27 &#8226; Synaptic conductances
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-07-06__Single_neuron_sim.html">
   2020-07-06 &#8226; Single neuron simulation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Unpolished Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../unpolished_intro.html">
   Intro
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-07-14__Unconnected-but-detected-with-self-bug.html">
   2022-07-14 &#8226; Not directly connected but detected &#8211; with self-bug
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-02-21__autobuild_jb_toc.html">
   2022-02-21 &#8226; Build jb toc automatically
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-02-18__scale_up_N_and_duration.html">
   2022-02-18 &#8226; Scale up N and duration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2022-01-04__Hello_Julia.html">
   2022-01-04 &#8226; Hello Julia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-18__prototype_new_sim.html">
   2021-11-18 &#8226; Prototype new sim
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-18__constant_input_spikes.html">
   2021-11-18 &#8226; Constant input spikes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-12-08__cortical_HH_vs_Izh_dV_shape.html">
   2021-12-08 &#8226; Cortical params for Hodgkin-Huxley
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-11-04__control_for_output_rate.html">
   2021-11-04 &#8226; Control for output spike rate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-03-10__cond_prob.html">
   2021-03-10 &#8226; Conditional pdf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-01-13__conntest_in_codebase.html">
   2021-01-13 &#8226; Connection test plot functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-01-02__full_network_sim_tryout.html">
   2020-01-02 &#8226; Trying out a full network simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2021-01-01__debug_parallel_calc_STA.html">
   2021-01-01 &#8226; Debug parallel
   <code class="docutils literal notranslate">
    <span class="pre">
     _calc_STA
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-30__speedup__spike_indices.html">
   2020-11-30 &#8226; Sparse spike trains
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-30__speedup.html">
   2020-11-30 &#8226; Speedup spikes &amp; STA calc
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-27__factor_out_STA.html">
   2020-11-27 &#8226; Factoring out windowing &amp; averaging code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-11-16__analytical_PSP.html">
   2020-11-16 Searching for an analytical form for the PSP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-07-28__Storing_in_base_units.html">
   2020-07-28 &#8226; Storing values in base units
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2020-07-05__Izhikevich_paper_accomp.html">
   2020-07-05 &#8226; Izhikevich paper testing
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/nb/2020-12-11__KS_test_exponential_distribution.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button" href="https://github.com/tfiers/phd"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left" title="Source repository"><i class="fab fa-github"></i>repository</button></a>
        <a class="issues-button" href="https://github.com/tfiers/phd/issues/new?title=Issue%20on%20page%20%2Fnb/2020-12-11__KS_test_exponential_distribution.html&amp;body=Your%20issue%20content%20here."><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left" title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/tfiers/phd/edit/main/web/nb/2020-12-11__KS_test_exponential_distribution.ipynb"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left" title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://notebooks.gesis.org/binder/v2/gh/tfiers/phd/main?urlpath=tree/web/nb/2020-12-11__KS_test_exponential_distribution.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="../_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
        
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports-time-grid">
   Imports &amp; time grid
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spike-trains">
   Spike trains
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inter-spike-intervals">
   Inter-spike intervals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fit-exponential">
   Fit exponential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qq-plot">
   QQ plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cdf-comparison">
   CDF comparison
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kolmogorov-smirnov-test">
   Kolmogorov-Smirnov test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#repro-info">
   Repro info
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>2020-12-11 &#8226; KS test exponential distribution</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports-time-grid">
   Imports &amp; time grid
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spike-trains">
   Spike trains
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inter-spike-intervals">
   Inter-spike intervals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fit-exponential">
   Fit exponential
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qq-plot">
   QQ plot
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cdf-comparison">
   CDF comparison
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#kolmogorov-smirnov-test">
   Kolmogorov-Smirnov test
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#repro-info">
   Repro info
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="ks-test-exponential-distribution">
<h1>2020-12-11 &#8226; KS test exponential distribution<a class="headerlink" href="#ks-test-exponential-distribution" title="Permalink to this headline">&#182;</a></h1>
<p>As a little aside / exercising of comp-stats muscles, we test whether the inter-spike-intervals are really exponentially distributed (and hence the generated spike trains Poisson distibuted).</p>
<p>(they of course will be, as we generate the trains by drawing ISI&#8217;s from an exponential distribution).</p>
<div class="section" id="imports-time-grid">
<h2>Imports &amp; time grid<a class="headerlink" href="#imports-time-grid" title="Permalink to this headline">&#182;</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">voltage_to_wiring_sim.support.notebook_init</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Preloading:
 - numpy &#8230; (0.12 s)
 - matplotlib.pyplot &#8230; (0.24 s)
 - numba &#8230; (0.32 s)

Importing from submodules (compiling numba functions) &#8230; &#10004;

Imported `np`, `mpl`, `plt`
Imported codebase (`voltage_to_wiring_sim`) as `v`
Imported `*` from `v.support.units`
Setup autoreload
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">print_reproducibility_info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<p>This cell was last run by <code class="docutils literal notranslate"><span class="pre">tfiers</span></code> on <code class="docutils literal notranslate"><span class="pre">yoga</span></code><br>on <strong>Tue 29 Dec</strong> 2020, at 21:27 (UTC+0100).</p>
<p><a class="reference external" href="https://github.com/tfiers/voltage-to-wiring-sim/tree/8e535019c7a3b9df975a1e9354cbabe15f26326d">Last git commit</a> (Tue 29 Dec 2020, 21:26).</p>
<p>Uncommited changes to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>  <span class="n">notebooks</span><span class="o">/</span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span><span class="n">__unitlib</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tg</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">TimeGrid</span><span class="p">(</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">minute</span><span class="p">,</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ms</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="spike-trains">
<h2>Spike trains<a class="headerlink" href="#spike-trains" title="Permalink to this headline">&#182;</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_in</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">p_connected</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">N_connected</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">N_in</span> <span class="o">*</span> <span class="n">p_connected</span><span class="p">)</span>
<span class="n">N_unconnected</span> <span class="o">=</span> <span class="n">N_in</span> <span class="o">-</span> <span class="n">N_connected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_spike</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">Hz</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gen_st</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">generate_Poisson_spikes</span>

<span class="n">v</span><span class="o">.</span><span class="n">fix_rng_seed</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">spike_trains_connected</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_st</span><span class="p">(</span><span class="n">f_spike</span><span class="p">,</span> <span class="n">tg</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_connected</span><span class="p">)]</span>
<span class="n">spike_trains_unconnected</span> <span class="o">=</span> <span class="p">[</span><span class="n">gen_st</span><span class="p">(</span><span class="n">f_spike</span><span class="p">,</span> <span class="n">tg</span><span class="o">.</span><span class="n">duration</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_unconnected</span><span class="p">)];</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Wall time: 18.3 ms
</pre></div>
</div>
</div>
</div>
<p>This was 1.77 seconds when generating full 0/1 signals. I.e. we got 10x speedup by switching to drawing ISI&#8217;s from an exponential and only saving spike times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_spike_trains</span> <span class="o">=</span> <span class="n">spike_trains_connected</span> <span class="o">+</span> <span class="n">spike_trains_unconnected</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time_slice</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">minute</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">second</span>

<span class="n">slice_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">time_slice</span> <span class="o">/</span> <span class="n">tg</span><span class="o">.</span><span class="n">timestep</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">i_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">slice_indices</span><span class="p">)</span>
<span class="n">t_slice</span> <span class="o">=</span> <span class="n">tg</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i_slice</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_spike_train_excerpt</span><span class="p">(</span><span class="n">spike_train</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">spike_trains</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spike_train</span><span class="p">,</span> <span class="n">time_slice</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_spike_train_excerpt</span><span class="p">(</span><span class="n">all_spike_trains</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_15_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_15_0.png">
</div>
</div>
</div>
<div class="section" id="inter-spike-intervals">
<h2>Inter-spike intervals<a class="headerlink" href="#inter-spike-intervals" title="Permalink to this headline">&#182;</a></h2>
<p>Aight.</p>
<p>Check if spike train&#8217;s are really Poisson; and thus that ISI&#8217;s are exponentially distributed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span> <span class="o">=</span> <span class="n">all_spike_trains</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ISIs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ISIs</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">norm_hist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Inter-spike interval (ms)"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_18_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_18_0.png">
</div>
</div>
</div>
<div class="section" id="fit-exponential">
<h2>Fit exponential<a class="headerlink" href="#fit-exponential" title="Permalink to this headline">&#182;</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">expon</span>

<span class="n">loc</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">ISIs</span> <span class="o">/</span> <span class="n">ms</span><span class="p">)</span>
<span class="n">loc</span><span class="p">,</span> <span class="n">scale</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.003623, 49.43)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pdf</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">expon</span><span class="o">.</span><span class="n">pdf</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_21_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_21_0.png">
</div>
</div>
</div>
<div class="section" id="qq-plot">
<h2>QQ plot<a class="headerlink" href="#qq-plot" title="Permalink to this headline">&#182;</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_quantiles</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># i.e. we'll plot percentiles</span>
<span class="n">quantiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_quantiles</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>  <span class="c1"># "ppf" = "percent point function" </span>
    <span class="c1">#                             #       = inverse cdf = quantiles</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">ISIs</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">'k.'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s1">'equal'</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s1">'x = ISI from exponential distribution (ms)'</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s1">'y = ISI from data</span><span class="se">\n</span><span class="s1">'</span>
           <span class="s1">'at same quantile as x (ms)'</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_23_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_23_0.png">
</div>
</div>
<p>Straight line: it fits &#128558;.</p>
</div>
<div class="section" id="cdf-comparison">
<h2>CDF comparison<a class="headerlink" href="#cdf-comparison" title="Permalink to this headline">&#182;</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">x_data</span> <span class="o">=</span> <span class="n">sorted_ISIs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">ISIs</span> <span class="o">/</span> <span class="n">ms</span><span class="p">)</span>
<span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_data</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Data"</span><span class="p">)</span>

<span class="n">x_pdf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">sorted_ISIs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sorted_ISIs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">y_pdf</span> <span class="o">=</span> <span class="n">expon</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x_pdf</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="n">bg_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pdf</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fitted exponential distribution"</span><span class="p">,</span> <span class="o">**</span><span class="n">bg_kwargs</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">"Inter-spike interval (ms)"</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">"CDF"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_26_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_26_0.png">
</div>
</div>
<p>Zoom in:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlim_orig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylim_orig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="n">xlim_superzoom</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">)</span>
<span class="n">ylim_superzoom</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.866</span><span class="p">,</span> <span class="mf">0.874</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim_superzoom</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim_superzoom</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_28_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_28_0.png">
</div>
</div>
<p>Combine zoomed views with original plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim_orig</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim_orig</span><span class="p">)</span>
<span class="n">in_ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">in_ax</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">in_ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<span class="n">in_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_pdf</span><span class="p">,</span> <span class="n">y_pdf</span><span class="p">,</span> <span class="o">**</span><span class="n">bg_kwargs</span><span class="p">)</span>
<span class="n">xlim_medium_zoom</span> <span class="o">=</span> <span class="p">(</span><span class="mi">88</span><span class="p">,</span> <span class="mi">108</span><span class="p">)</span>
<span class="n">ylim_medium_zoom</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.88</span><span class="p">)</span>
<span class="n">in_ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="n">xlim_medium_zoom</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">ylim_medium_zoom</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">indicate_inset_zoom</span><span class="p">(</span><span class="n">in_ax</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">in_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">in_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
<span class="c1"># Mark superzoom of above _inside_ inset.</span>
<span class="c1"># </span>
<span class="c1"># `in_ax.indicate_inset` doesn't work for some reason.</span>
<span class="c1"># Hence the manual Rectangle.</span>
<span class="n">in_ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">xlim_superzoom</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim_superzoom</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">width</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">xlim_superzoom</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">height</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ylim_superzoom</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">ec</span><span class="o">=</span><span class="s1">'grey'</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2020-12-11__KS_test_exponential_distribution_30_0.png" src="../_images/2020-12-11__KS_test_exponential_distribution_30_0.png">
</div>
</div>
</div>
<div class="section" id="kolmogorov-smirnov-test">
<h2>Kolmogorov-Smirnov test<a class="headerlink" href="#kolmogorov-smirnov-test" title="Permalink to this headline">&#182;</a></h2>
<p>Quantify distance between CDF&#8217;s with (two-sided) Kolmogorov-Smirnov test.</p>
<p>KS test statistic is maximum vertical distance between CDF&#8217;s.<br>
p-value is calculated based on this statistic and the <a class="reference external" href="https://www.wikiwand.com/en/Kolmogorov%E2%80%93Smirnov_test#/Kolmogorov_distribution">Kolmogorov distribution</a>
(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ksone.html#scipy.stats.ksone">SciPy implementation</a>)
&#8211; which in turn is based on Brownian motion i.e. random walks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kstest</span>
<span class="n">kstest</span><span class="p">(</span><span class="n">ISIs</span> <span class="o">/</span> <span class="n">ms</span><span class="p">,</span> <span class="n">expon</span><span class="o">.</span><span class="n">cdf</span><span class="p">,</span> <span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KstestResult(statistic=0.005775131258583199, pvalue=0.8107313119920425)
</pre></div>
</div>
</div>
</div>
<p>We reject H1 that the data is not drawn from an exponential distribution (<span class="math notranslate nohighlight">\(p \gg 0.05\)</span>).</p>
<p>Addendum: this statistical analysis is not entirely correct,
because the KS test assumes that the parameters of the probability distribution
are not determined from the data (as we have done here).
Some correction to the statistic/p-value would be needed to correct for that</p>
</div>
<div class="section" id="repro-info">
<h2>Repro info<a class="headerlink" href="#repro-info" title="Permalink to this headline">&#182;</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">print_reproducibility_info</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<p>This cell was last run by <code class="docutils literal notranslate"><span class="pre">tfiers</span></code> on <code class="docutils literal notranslate"><span class="pre">yoga</span></code><br>on <strong>Tue 29 Dec</strong> 2020, at 21:27 (UTC+0100).</p>
<p><a class="reference external" href="https://github.com/tfiers/voltage-to-wiring-sim/tree/8e535019c7a3b9df975a1e9354cbabe15f26326d">Last git commit</a> (Tue 29 Dec 2020, 21:26).</p>
<p>Uncommited changes to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>  <span class="n">notebooks</span><span class="o">/</span><span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">11</span><span class="n">__unitlib</span><span class="o">.</span><span class="n">ipynb</span>
</pre></div>
</div>
<p>Platform:</p>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Windows-10
CPython 3.8.3 (C:\conda\python.exe)
Intel(R) Core(TM) i7-10510U CPU @ 1.80GHz
</pre></div>
</div>
<p>Dependencies of <code class="docutils literal notranslate"><span class="pre">voltage_to_wiring_sim</span></code> and their installed versions:</p>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy                1.19.2
matplotlib           3.3.2
numba                0.51.2
seaborn              0.10.1
scipy                1.5.2
scikit-learn         0.23.2
preload              2.1
py-cpuinfo           7.0.0
nptyping             1.3.0
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./nb"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class="prev-next-area"> 
    <a class="left-prev" id="prev-link" href="2020-12-30__test_all_connections.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">2020-12-30 &#8226; Test connection of <em>all</em> incoming neurons</p>
        </div>
    </a>
    <a class="right-next" id="next-link" href="2020-11-27__permutation_test.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2020-11-27 &#8226; Permutation test for <span class="math notranslate nohighlight">\(p(\)</span>connected<span class="math notranslate nohighlight">\()\)</span></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Tomas Fiers<br>
    
        &#169; Copyright 2020.<br>
      </p><div class="extra_footer">
        <script src="https://hypothes.is/embed.js" async></script>

      </div>
  
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>