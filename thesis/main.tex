\documentclass[a4paper, oneside, 11pt]{memoir}
\input{totex/Settings.tex}
\input{totex/Commands.tex}


\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.3}

\definecolor{LighterBlack}{gray}{0.4}


% No '(2.8)' for equations, rather just '(10)'
\counterwithout{equation}{chapter}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}
% for listings, this is done by lstset numberbychapter=false, in totex/Settings.tex

\renewcommand{\d}[2][t]{\ensuremath{\frac{\mathrm{d}#2}{\mathrm{d}#1}}}
\newcommand*{\dd}[1]{\ensuremath{\frac{\mathrm{d}}{\mathrm{d}#1}}}

\newcommand*{\nburl}[1]{{\footnotesize\texttt{\href{https://tfiers.github.io/phd/nb/#1.html}{\replunderscores{#1}}}}}

% Thx https://stackoverflow.com/a/57028315/2611913
% (with addition of \allowbreak)
\makeatletter
\newcommand{\replunderscores}[1]{\expandafter\@repl@underscores#1_\relax}
\def\@repl@underscores#1_#2\relax{%
    \ifx \relax #2\relax
        #1%
    \else
        #1%
        \textunderscore\allowbreak
        \@repl@underscores#2\relax
    \fi
}
\makeatother

% \newcommand{\mpl}[1]{#1}
% \newcommand{\mpl}[1]{\IfStrEqCase{b}{{b}{BB}{a}{AA}}}
%         {blue}{blueyyy}%
% %         {blue}{\textcolor[HTML]{1F77B4}{blue}}%
% %         {orange}{\textcolor[HTML]{FF7F0E}{orange}}%
% %         {green}{\textcolor[HTML]{2CA02C}{green}}%
% %         {red}{\textcolor[HTML]{D62728}{red}}%
%     }[#1]%
% }

% `\IfStrEqCase' from xstring didn't work (it did in an MWE; but some bad interaction)
%  ("Illegal parameter number in definition of \@tempa")
% (https://tex.stackexchange.com/a/61602/153868).
%
% New style, using xparse and latex3 cmds,
% from e.g. https://tex.stackexchange.com/a/61603/153868, does work
\ExplSyntaxOn
\NewDocumentCommand{\mpl}{m}
  {
   \str_case:nnF { #1 }
     {
      {blue} {\textcolor[rgb]{0.106, 0.408, 0.616}{blue}}
      {orange} {\textcolor[rgb]{0.871, 0.431, 0.047}{orange}}
      {green} {\textcolor[rgb]{0.149, 0.545, 0.149}{green}}
      {red} {\textcolor[rgb]{0.729, 0.133, 0.137}{red}}
      {purple} {\textcolor[rgb]{0.506, 0.353, 0.643}{purple}}
      {brown} {\textcolor[rgb]{0.478, 0.294, 0.255}{brown}}
     }
     {#1}
  }
\ExplSyntaxOff
% mpl colours, but darkened a bit (to make thin text visually match thick lines).
% Calculated at 2023-08-30__STA_examples.

% Command that does nothing.
% To be able to have autocomplete of sidecaption labels for vscode LaTeX-Workshop
% [https://github.com/James-Yu/LaTeX-Workshop/wiki/Intellisense#references]
\newcommand*{\linelabel}[1]{}
% (using a self-defined command ("\sclabel") didn't work. So using this one, that had
% not yet a def here).

% For "1st" etc. (May not use `^{}')
\newcommand{\ts}{\textsuperscript}

\newcommand*{\exc}{\text{exc}}
\newcommand*{\inh}{\text{inh}}
\newcommand*{\syn}{\text{syn}}

\newcommand*{\maxF}{\ensuremath{\max{}\,F_1}\xspace}

\newunicodechar{≤}{\ensuremath{\le}}
\newunicodechar{≥}{\ensuremath{\ge}}
\newunicodechar{≠}{\ensuremath{\neq}}
\newunicodechar{≈}{\ensuremath{\approx}}
\newunicodechar{≡}{\ensuremath{\equiv}}
\newunicodechar{Δ}{\ensuremath{\Delta}}
% Weird: Typing `\Delta' in plain text works, but
%   \newunicodechar{Δ}{\Delta}
% doesn't.
\newunicodechar{α}{\ensuremath{\alpha}}
\newunicodechar{β}{\ensuremath{\beta}}
\newunicodechar{θ}{\ensuremath{\theta}}
\newunicodechar{μ}{\ensuremath{\mu}}
\newunicodechar{σ}{\ensuremath{\sigma}}
\newunicodechar{τ}{\ensuremath{\tau}}
\newunicodechar{δ}{\ensuremath{\delta}}
\newunicodechar{ε}{\ensuremath{\varepsilon}}
\newunicodechar{λ}{\ensuremath{\lambda}}
% \newunicodechar{×}{\ensuremath{\times}}  % not needed (outside math)
\newunicodechar{×}{\ensuremath{\times}}
\newunicodechar{₁}{\ensuremath{_1}}
\newunicodechar{₂}{\ensuremath{_2}}
\newunicodechar{ₘ}{\ensuremath{_\text{m}}}
\newunicodechar{ₛ}{\ensuremath{_\text{s}}}
\newunicodechar{ᵢ}{\ensuremath{_{i}}}
\newunicodechar{ⱼ}{\ensuremath{_{j}}}
\newunicodechar{–}{\ensuremath{-}}
\newunicodechar{·}{\ensuremath{\cdot}}
\newunicodechar{→}{\ensuremath{\rightarrow}}
\newunicodechar{←}{\ensuremath{\leftarrow}}
\newunicodechar{∀}{\ensuremath{\forall}}
\newunicodechar{∈}{\ensuremath{\in}}
\newunicodechar{∞}{\ensuremath{\infty}}
\newunicodechar{…}{\ensuremath{\mathellipsis}}


\addbibresource{references.bib}

\graphicspath{{figs/}}

\begin{document}

\chapter*{Preamble}

Figures and tables in this document are often accompanied by a link to the Jupyter Notebook that generated them. These notebooks contain more information than can be conveyed in just the caption. These links look like, e.g:
\nburl{2021-12-06__local_HH_dV_shape}.
To visit these links, in the digital version of this document, just click them. In the paper version, convert them to an URL as follows: {\small \url{https://tfiers.github.io/phd/nb/2021-12-06__local_HH_dV_shape.html}}.


\chapter{Introduction}

\begin{itemize}
    \item Problem statement
    \item Opportunity of voltage imaging, core idea of inverting the causal `presynaptic spike → postsynaptic PSP' relation
    \item Overview of thesis
\end{itemize}

\input{ch1.tex}
\clearpage

\section{Connectomics}

\begin{itemize}
    \item Motivation
    \item Ground-truth connectomics: tracing of electron microscopy and fluoresent injection imaging
    \item Necessity of connection \emph{inference}
    \item Mention `invasive' connection testing (stimulate one cell, record possible neighbours)
    \item Limitations of `connectomics', and of inferred vs `actual' connectomics.\\
        Terminology, e.g. `functional connectomics'
\end{itemize}


\section{Voltage imaging}

\begin{itemize}
    \item Technologies (from dyes to GEVIs)
    \item Specs: cell yield, tissue depth, recording duration, SNR, species
    \item ..and growth of these over time, and comparison with calcium imaging.\\
        To extrapolate how these might advance in the future
    \item Comparison with other recording techniques: ephys, calcium imaging, (and briefly mention coarser methods)
\end{itemize}


\section{Network inference}

\begin{itemize}
    \item Working with events/spikes only, versus working with continuous signals; or a hybrid as here.
    \item Overview of the spikes-only methods
    \item The connectomics competition, and the findings about the best methods
    \item Mention other application domains, like gene regulatory networks
    \item Conclusion: connection inference by spikes is poor (Ila Fiete etc), and Vm imaging offers unique advantage (causality)
    % \item 'Spike-triggered voltage regression' of Zhou/Cai
\end{itemize}



% \chapter{Connection tests \&\\ the N-to-1 experiment}

\chapter{Simulation details}

In this chapter, we decribe our experimental setup: the neuron model we simulate, its inputs, and how we simulate voltage imaging.

\input{ch2.tex}

% TODO here:
% - Make an appendix, put in the math derivations of Izh and AdEx (and the comparison table). In main text, only have all current figs (F(V), slow rampup, nonlinear subthr), and a summary of the text reasons for Izh→AdEx. (and add a little historical note: most of the phd done with izh, so there was some switching cost, so we need to justify the switch well :)).

% \begin{itemize}
%     \item AdEx neuron, synapse model, exc and inh inputs
%     \item Poisson spike generation
%     \item Lognormal distribution of input firing rates
%     \item Influence of N \& input strength, on output firing rate \& average voltage level
%     % \item Evaluation plots
% \end{itemize}


\chapter{Spike-triggered averaging}
\label{ch:STA}

\input{ch3.tex}

% \begin{itemize}
%     \item Principle, example STAs
%     \item Influence on STA of E/I balance, output firing rate, reversal potentials
%     \item Use as connection test: shuffled spike trains and height of STA, p-values, and the `area-over-start' heuristic for E vs I classification.
%     \item Evaluation of a connection test: `ternary' classification, summary measures, AUROC
%     \item Performance of the simple STA-height test, for different N
%     \item Influence of window length
%     \item What about Vm imaging affects detection the most?
% \end{itemize}


\chapter{New connection inference methods}
\label{ch4}
\input{ch4.tex}



\chapter{Network model}

\begin{itemize}
    \item Network connectivity, E/I balance, raster plots
    \item Too many possible connections to test them all → Subsampling
    \item Performance of last chapter's methods
    \item If time: experiment with a network that is less densely connected than our current fully-random one. Why? To better examine the effect of indirect connections / colliders (For the current connectivity, there are too many of those. But in a more realistic, 'localized' network, there are less, and so it seems easier to isolate and examine their effect).
\end{itemize}


\chapter{Discussion}

\section{Summary \& conclusions}

..

\section{Future work}

\begin{itemize}
    \item Test on real data
    \item Direct comparison with spikes-only methods
    \item More complexity in the testing setup: different transmission delays and time constants per synapse / neuron, plus:
    \item Short term synaptic plasticity. Bursting. Oscillations.
    \item Simulate different brain areas (different cell types and connectivity patterns). Simulate the same area, but in different states (up vs down, e.g.)
    \item New connection test method to try: something deep learning-based (we have infinite training data, given our simulation)
\end{itemize}

\References

\end{document}
